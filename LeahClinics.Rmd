---
title: "Maine Clinics"
author: "Christine Iyer"
date: "April 10, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```

[For reference](http://rpubs.com/chrisiyer/221519)

```{r}
library(leaflet)
library(rgdal)
library(ggmap)
library(dplyr)
library(knitr)
City <- c("Bangor", "Belfast","Calais", "Damariscotta", "Dexter", "Ellsworth", "Farmington", "Fort Kent", "Houlton", "Lewiston", "Machias", "Norway", "Presque Isle",  "Rockland", "Rumford", "Skowhegan","Waterville")
Clinics <- c(18, 1, 1, 1, 1,3,1, 19, 3, 10, 2,2,13,11,1,8,3)
City <- as.character(City)
City <- paste(City, "Maine",sep = " ")
Location <- geocode(City[1:17])
Population <- c(33039, 6682,3123, 1142, 2158, 7741, 4288, 2488, 4856, 36592, 1274, 2748, 9692, 7297, 4218, 6297, 15722)
COUNTY <- c("Penobscot", "Waldo", "Washington", "Lincoln", "Penobscot", "Hancock", "Franklin", "Aroostook", "Aroostook", "Androscoggin", "Washington", "Oxford", "Aroostook","Knox", "Oxford", "Somerset", "Kennebec")
Leahs <- cbind.data.frame(City, Clinics, Population, Location, COUNTY)
Leahs <- mutate(Leahs, City = gsub(" Maine", "", City))
kable(Leahs)
```

```{r}
IconHosp <- makeIcon(iconUrl = "https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcTaNgIjVruTY_rebXeXNgWuDQGMNrJ_rXaBZ0PIQzz-TCyzCcsddA", iconWidth = 31*215/230, iconHeight = 31, iconAnchorX = 31*215/230/2, iconAnchorY = 16)
popupLabel <- paste(Leahs$City, " has ", Leahs$Clinics, " clinics\nfor your abortion pleasure")
```


```{r}
New <- leaflet() %>% addTiles() %>% addMarkers(lng = Leahs$lon, lat = Leahs$lat, icon = IconHosp, popup = popupLabel) %>% setView(lng = -70.0589, lat = 43.3601, zoom = 6) %>% addProviderTiles("CartoDB.Positron")
New
```

```{r}
library(rgdal)
library(raster)
#setwd("/Users/Chris Iyer/Documents/county/")
me_counties <- me_counties <- readOGR("./county", "county")
kable(head(me_counties))
names(me_counties)
me_counties <- spTransform(me_counties, CRS("+proj=longlat +datum=WGS84"))
pal <- colorQuantile("PuRd", NULL, n = 4)

```

```{r}
head(me_counties)
CountyClinic <- merge(me_counties, Leahs,  by.x =  "COUNTY", by.y = "Population")
head(CountyClinic)

```


```{r}
leaflet() %>% 
  addProviderTiles("CartoDB.Positron") %>% 
  addPolygons(data = CountyClinic,
              popup = ~COUNTY , fillColor = ~pal(CountyClinic$Clinics), color = "##D46A6A", weight = 1)
```

